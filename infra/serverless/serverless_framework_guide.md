# Serverless Framework ÂÆåÂÖ®„Ç¨„Ç§„Éâ

## ÁõÆÊ¨°
- [Serverless Framework„Å®„ÅØ](#serverless-framework„Å®„ÅØ)
- [„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó](#„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó)
- [„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†](#„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†)
- [serverless.ymlË®≠ÂÆö](#serverlessymlË®≠ÂÆö)
- [Èñ¢Êï∞ÂÆöÁæ©](#Èñ¢Êï∞ÂÆöÁæ©)
- [„Ç§„Éô„É≥„ÉàË®≠ÂÆö](#„Ç§„Éô„É≥„ÉàË®≠ÂÆö)
- [„É™„ÇΩ„Éº„ÇπÁÆ°ÁêÜ](#„É™„ÇΩ„Éº„ÇπÁÆ°ÁêÜ)
- [„Éó„É©„Ç∞„Ç§„É≥](#„Éó„É©„Ç∞„Ç§„É≥)
- [„Éá„Éó„É≠„Ç§](#„Éá„Éó„É≠„Ç§)
- [Áí∞Â¢ÉÂ§âÊï∞„Å®„Ç∑„Éº„ÇØ„É¨„ÉÉ„Éà](#Áí∞Â¢ÉÂ§âÊï∞„Å®„Ç∑„Éº„ÇØ„É¨„ÉÉ„Éà)
- [„É¢„Éã„Çø„É™„É≥„Ç∞](#„É¢„Éã„Çø„É™„É≥„Ç∞)
- [„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ](#„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ)

---

## Serverless Framework„Å®„ÅØ

„Çµ„Éº„Éê„Éº„É¨„Çπ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÁ∞°Âçò„Å´ÊßãÁØâ„Éª„Éá„Éó„É≠„Ç§„Åß„Åç„Çã„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„ÄÇ

### ÁâπÂæ¥

- üöÄ Á∞°Âçò„Éá„Éó„É≠„Ç§: 1„Ç≥„Éû„É≥„Éâ„Åß„Éá„Éó„É≠„Ç§
- ‚òÅÔ∏è „Éû„É´„ÉÅ„ÇØ„É©„Ç¶„Éâ: AWS, Azure, GCPÂØæÂøú
- üì¶ „Ç§„É≥„Éï„É©„Ç≥„Éº„ÉâÂåñ: YAML „Åß„Ç§„É≥„Éï„É©ÂÆöÁæ©
- üîå „Éó„É©„Ç∞„Ç§„É≥„Ç∑„Çπ„ÉÜ„É†: Êã°ÂºµÊÄß„ÅåÈ´ò„ÅÑ
- üåç Â§öË®ÄË™ûÂØæÂøú: Node.js, Python, Go, JavaÁ≠â

### „É¶„Éº„Çπ„Ç±„Éº„Çπ

```
‚úì REST API / GraphQL API
‚úì „Éê„ÉÉ„ÉÅÂá¶ÁêÜ
‚úì „Ç§„Éô„É≥„ÉàÈßÜÂãïÂá¶ÁêÜ
‚úì Webhook
‚úì „Éá„Éº„Çø„Éë„Ç§„Éó„É©„Ç§„É≥
‚úì „Éû„Ç§„ÇØ„É≠„Çµ„Éº„Éì„Çπ
```

---

## „Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó

### „Ç§„É≥„Çπ„Éà„Éº„É´

```bash
# Serverless Framework CLI „Ç§„É≥„Çπ„Éà„Éº„É´
npm install -g serverless

# „Éê„Éº„Ç∏„Éß„É≥Á¢∫Ë™ç
serverless --version

# „Ç®„Ç§„É™„Ç¢„Çπ
sls --version
```

### AWSË™çË®ºÊÉÖÂ†±Ë®≠ÂÆö

```bash
# AWS CLI„ÅßË®≠ÂÆö
aws configure

# „Åæ„Åü„ÅØÁí∞Â¢ÉÂ§âÊï∞
export AWS_ACCESS_KEY_ID=your_access_key
export AWS_SECRET_ACCESS_KEY=your_secret_key
```

### „Éó„É≠„Ç∏„Çß„ÇØ„Éà‰ΩúÊàê

```bash
# „ÉÜ„É≥„Éó„É¨„Éº„Éà„Åã„Çâ‰ΩúÊàê
serverless create --template aws-nodejs-typescript --path my-service

# Âà©Áî®ÂèØËÉΩ„Å™„ÉÜ„É≥„Éó„É¨„Éº„Éà‰∏ÄË¶ß
serverless create --help

# ‰∏ª„Å™„ÉÜ„É≥„Éó„É¨„Éº„Éà
- aws-nodejs          # Node.js
- aws-nodejs-typescript  # TypeScript
- aws-python3         # Python
- aws-go              # Go
```

---

## „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†

### Âü∫Êú¨ÊßãÈÄ†

```
my-service/
‚îú‚îÄ‚îÄ serverless.yml      # „Çµ„Éº„Éì„ÇπË®≠ÂÆö
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ functions/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hello.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ getUser.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ createOrder.ts
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ db.ts
‚îÇ       ‚îî‚îÄ‚îÄ response.ts
‚îî‚îÄ‚îÄ .env                # Áí∞Â¢ÉÂ§âÊï∞ÔºàgitignoreÊé®Â•®Ôºâ
```

### Â§ßË¶èÊ®°„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÈÄ†

```
my-app/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ serverless.yml
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handler.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ products/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ serverless.yml
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ handler.ts
‚îÇ   ‚îî‚îÄ‚îÄ orders/
‚îÇ       ‚îú‚îÄ‚îÄ serverless.yml
‚îÇ       ‚îî‚îÄ‚îÄ handler.ts
‚îú‚îÄ‚îÄ shared/
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ types/
‚îî‚îÄ‚îÄ package.json
```

---

## serverless.ymlË®≠ÂÆö

### Âü∫Êú¨Ë®≠ÂÆö

```yaml
# serverless.yml
service: my-api

frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs18.x
  stage: ${opt:stage, 'dev'}
  region: ap-northeast-1

  # IAM„É≠„Éº„É´
  iam:
    role:
      statements:
        - Effect: Allow
          Action:
            - dynamodb:Query
            - dynamodb:GetItem
            - dynamodb:PutItem
          Resource: "arn:aws:dynamodb:${self:provider.region}:*:table/${self:custom.tableName}"

  # Áí∞Â¢ÉÂ§âÊï∞
  environment:
    TABLE_NAME: ${self:custom.tableName}
    API_KEY: ${env:API_KEY}

# „Ç´„Çπ„Çø„É†Â§âÊï∞
custom:
  tableName: ${self:service}-${self:provider.stage}-table

# Èñ¢Êï∞ÂÆöÁæ©
functions:
  hello:
    handler: src/functions/hello.handler
    events:
      - httpApi:
          path: /hello
          method: get

# „É™„ÇΩ„Éº„Çπ
resources:
  Resources:
    UsersTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: ${self:custom.tableName}
        BillingMode: PAY_PER_REQUEST
        AttributeDefinitions:
          - AttributeName: PK
            AttributeType: S
          - AttributeName: SK
            AttributeType: S
        KeySchema:
          - AttributeName: PK
            KeyType: HASH
          - AttributeName: SK
            KeyType: RANGE

# „Éó„É©„Ç∞„Ç§„É≥
plugins:
  - serverless-offline
  - serverless-esbuild
```

### Ë§áÊï∞Áí∞Â¢ÉÂØæÂøú

```yaml
# serverless.yml
provider:
  name: aws
  runtime: nodejs18.x
  stage: ${opt:stage, 'dev'}
  region: ${opt:region, 'ap-northeast-1'}

  environment:
    STAGE: ${self:provider.stage}
    DB_NAME: myapp-${self:provider.stage}
    LOG_LEVEL: ${self:custom.logLevels.${self:provider.stage}}

custom:
  logLevels:
    dev: debug
    staging: info
    prod: warn

  # „Çπ„ÉÜ„Éº„Ç∏Âà•Ë®≠ÂÆö
  stages:
    dev:
      memorySize: 256
      timeout: 30
    prod:
      memorySize: 1024
      timeout: 10

functions:
  api:
    handler: handler.main
    memorySize: ${self:custom.stages.${self:provider.stage}.memorySize}
    timeout: ${self:custom.stages.${self:provider.stage}.timeout}
```

---

## Èñ¢Êï∞ÂÆöÁæ©

### Âü∫Êú¨ÁöÑ„Å™Èñ¢Êï∞

```typescript
// src/functions/hello.ts
import { APIGatewayProxyHandler } from 'aws-lambda'

export const handler: APIGatewayProxyHandler = async (event, context) => {
  return {
    statusCode: 200,
    body: JSON.stringify({
      message: 'Hello from Serverless!',
      input: event
    })
  }
}
```

```yaml
# serverless.yml
functions:
  hello:
    handler: src/functions/hello.handler
    description: Hello function
    memorySize: 256
    timeout: 10
    events:
      - httpApi:
          path: /hello
          method: get
```

### TypeScript + ÂûãÂÆâÂÖ®

```typescript
// src/types/api.ts
export interface UserCreateRequest {
  email: string
  name: string
}

export interface UserResponse {
  id: string
  email: string
  name: string
  createdAt: string
}

// src/functions/createUser.ts
import { APIGatewayProxyHandler } from 'aws-lambda'
import { DynamoDBClient } from '@aws-sdk/client-dynamodb'
import { DynamoDBDocumentClient, PutCommand } from '@aws-sdk/lib-dynamodb'
import { UserCreateRequest, UserResponse } from '../types/api'

const client = DynamoDBDocumentClient.from(new DynamoDBClient({}))
const TABLE_NAME = process.env.TABLE_NAME!

export const handler: APIGatewayProxyHandler = async (event) => {
  try {
    const request: UserCreateRequest = JSON.parse(event.body || '{}')

    if (!request.email || !request.name) {
      return {
        statusCode: 400,
        body: JSON.stringify({ error: 'Email and name are required' })
      }
    }

    const user: UserResponse = {
      id: crypto.randomUUID(),
      email: request.email,
      name: request.name,
      createdAt: new Date().toISOString()
    }

    await client.send(new PutCommand({
      TableName: TABLE_NAME,
      Item: {
        PK: `USER#${user.id}`,
        SK: 'PROFILE',
        ...user
      }
    }))

    return {
      statusCode: 201,
      body: JSON.stringify(user)
    }
  } catch (error) {
    console.error('Error:', error)
    return {
      statusCode: 500,
      body: JSON.stringify({ error: 'Internal server error' })
    }
  }
}
```

### Èñ¢Êï∞„ÅÆÂàÜÂâ≤

```yaml
# serverless.yml
functions:
  # „É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ
  getUser:
    handler: src/functions/users/get.handler
    events:
      - httpApi:
          path: /users/{id}
          method: get

  createUser:
    handler: src/functions/users/create.handler
    events:
      - httpApi:
          path: /users
          method: post

  # Ê≥®ÊñáÁÆ°ÁêÜ
  getOrders:
    handler: src/functions/orders/list.handler
    events:
      - httpApi:
          path: /orders
          method: get

  createOrder:
    handler: src/functions/orders/create.handler
    events:
      - httpApi:
          path: /orders
          method: post
```

---

## „Ç§„Éô„É≥„ÉàË®≠ÂÆö

### HTTP API (API Gateway v2)

```yaml
functions:
  api:
    handler: handler.main
    events:
      # Âü∫Êú¨
      - httpApi:
          path: /users
          method: get

      # „Éë„Çπ„Éë„É©„É°„Éº„Çø
      - httpApi:
          path: /users/{id}
          method: get

      # Ë™çÂèØ
      - httpApi:
          path: /admin
          method: post
          authorizer:
            name: customAuthorizer

      # CORS
      - httpApi:
          path: /api
          method: any
          cors:
            origin: '*'
            headers:
              - Content-Type
              - Authorization
```

### REST API (API Gateway v1)

```yaml
functions:
  api:
    handler: handler.main
    events:
      - http:
          path: users
          method: get
          cors: true

      - http:
          path: users/{id}
          method: get
          request:
            parameters:
              paths:
                id: true

      # „É™„ÇØ„Ç®„Çπ„Éà„Éê„É™„Éá„Éº„Ç∑„Éß„É≥
      - http:
          path: users
          method: post
          request:
            schemas:
              application/json: ${file(schemas/user-create.json)}
```

### DynamoDB Streams

```yaml
functions:
  processStream:
    handler: src/functions/processStream.handler
    events:
      - stream:
          type: dynamodb
          arn:
            Fn::GetAtt:
              - UsersTable
              - StreamArn
          batchSize: 10
          startingPosition: LATEST
          maximumRetryAttempts: 2
```

```typescript
// src/functions/processStream.ts
import { DynamoDBStreamHandler } from 'aws-lambda'

export const handler: DynamoDBStreamHandler = async (event) => {
  for (const record of event.Records) {
    console.log('Event:', record.eventName)

    if (record.eventName === 'INSERT') {
      const newItem = record.dynamodb?.NewImage
      console.log('New item:', newItem)
      // Âá¶ÁêÜ...
    }
  }
}
```

### S3„Ç§„Éô„É≥„Éà

```yaml
functions:
  processUpload:
    handler: src/functions/processUpload.handler
    events:
      - s3:
          bucket: my-bucket
          event: s3:ObjectCreated:*
          rules:
            - prefix: uploads/
            - suffix: .jpg
          existing: true
```

### SQS

```yaml
functions:
  processQueue:
    handler: src/functions/processQueue.handler
    events:
      - sqs:
          arn:
            Fn::GetAtt:
              - MyQueue
              - Arn
          batchSize: 10
          maximumBatchingWindowInSeconds: 5
```

### EventBridge (CloudWatch Events)

```yaml
functions:
  scheduled:
    handler: src/functions/scheduled.handler
    events:
      # Cron
      - schedule:
          rate: cron(0 12 * * ? *)
          description: 'Run at noon every day'

      # Rate
      - schedule:
          rate: rate(5 minutes)

      # EventBridge
      - eventBridge:
          pattern:
            source:
              - aws.ec2
            detail-type:
              - EC2 Instance State-change Notification
```

### SNS

```yaml
functions:
  processNotification:
    handler: src/functions/processNotification.handler
    events:
      - sns:
          arn: arn:aws:sns:ap-northeast-1:123456789:my-topic
          topicName: MyTopic
```

---

## „É™„ÇΩ„Éº„ÇπÁÆ°ÁêÜ

### DynamoDB „ÉÜ„Éº„Éñ„É´

```yaml
resources:
  Resources:
    UsersTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: ${self:service}-${self:provider.stage}-users
        BillingMode: PAY_PER_REQUEST
        AttributeDefinitions:
          - AttributeName: PK
            AttributeType: S
          - AttributeName: SK
            AttributeType: S
          - AttributeName: email
            AttributeType: S
        KeySchema:
          - AttributeName: PK
            KeyType: HASH
          - AttributeName: SK
            KeyType: RANGE
        GlobalSecondaryIndexes:
          - IndexName: EmailIndex
            KeySchema:
              - AttributeName: email
                KeyType: HASH
            Projection:
              ProjectionType: ALL
        StreamSpecification:
          StreamViewType: NEW_AND_OLD_IMAGES
```

### S3 „Éê„Ç±„ÉÉ„Éà

```yaml
resources:
  Resources:
    UploadsBucket:
      Type: AWS::S3::Bucket
      Properties:
        BucketName: ${self:service}-${self:provider.stage}-uploads
        CorsConfiguration:
          CorsRules:
            - AllowedOrigins:
                - '*'
              AllowedMethods:
                - GET
                - PUT
                - POST
              AllowedHeaders:
                - '*'
        PublicAccessBlockConfiguration:
          BlockPublicAcls: true
          BlockPublicPolicy: true
          IgnorePublicAcls: true
          RestrictPublicBuckets: true
```

### SQS „Ç≠„É•„Éº

```yaml
resources:
  Resources:
    ProcessQueue:
      Type: AWS::SQS::Queue
      Properties:
        QueueName: ${self:service}-${self:provider.stage}-queue
        VisibilityTimeout: 300
        MessageRetentionPeriod: 1209600
        RedrivePolicy:
          deadLetterTargetArn:
            Fn::GetAtt:
              - ProcessDLQ
              - Arn
          maxReceiveCount: 3

    ProcessDLQ:
      Type: AWS::SQS::Queue
      Properties:
        QueueName: ${self:service}-${self:provider.stage}-dlq
        MessageRetentionPeriod: 1209600
```

### CloudWatch Logs

```yaml
resources:
  Resources:
    ApiLogGroup:
      Type: AWS::Logs::LogGroup
      Properties:
        LogGroupName: /aws/lambda/${self:service}-${self:provider.stage}-api
        RetentionInDays: 7
```

### Âá∫ÂäõÔºàOutputsÔºâ

```yaml
resources:
  Outputs:
    ApiUrl:
      Description: API Gateway URL
      Value:
        Fn::Sub: https://${HttpApi}.execute-api.${AWS::Region}.amazonaws.com
      Export:
        Name: ${self:service}-${self:provider.stage}-api-url

    TableName:
      Description: DynamoDB Table Name
      Value:
        Ref: UsersTable
      Export:
        Name: ${self:service}-${self:provider.stage}-table-name
```

---

## „Éó„É©„Ç∞„Ç§„É≥

### ÂøÖÈ†à„Éó„É©„Ç∞„Ç§„É≥

```bash
# TypeScript „Çµ„Éù„Éº„Éà
npm install -D serverless-esbuild

# „É≠„Éº„Ç´„É´ÈñãÁô∫
npm install -D serverless-offline

# Áí∞Â¢ÉÂ§âÊï∞ÁÆ°ÁêÜ
npm install -D serverless-dotenv-plugin
```

```yaml
# serverless.yml
plugins:
  - serverless-esbuild
  - serverless-offline
  - serverless-dotenv-plugin

custom:
  esbuild:
    bundle: true
    minify: true
    sourcemap: true
    target: node18
    exclude:
      - aws-sdk
      - '@aws-sdk/*'

  serverless-offline:
    httpPort: 3000
    lambdaPort: 3002
```

### ‰æøÂà©„Å™„Éó„É©„Ç∞„Ç§„É≥

#### serverless-prune-pluginÔºàÂè§„ÅÑ„Éê„Éº„Ç∏„Éß„É≥ÂâäÈô§Ôºâ

```bash
npm install -D serverless-prune-plugin
```

```yaml
plugins:
  - serverless-prune-plugin

custom:
  prune:
    automatic: true
    number: 3  # ÊúÄÊñ∞3„Éê„Éº„Ç∏„Éß„É≥„ÅÆ„Åø‰øùÊåÅ
```

#### serverless-domain-managerÔºà„Ç´„Çπ„Çø„É†„Éâ„É°„Ç§„É≥Ôºâ

```bash
npm install -D serverless-domain-manager
```

```yaml
plugins:
  - serverless-domain-manager

custom:
  customDomain:
    domainName: api.example.com
    certificateName: '*.example.com'
    basePath: ''
    stage: ${self:provider.stage}
    createRoute53Record: true
```

#### serverless-webpackÔºàWebpackÔºâ

```bash
npm install -D serverless-webpack webpack
```

```yaml
plugins:
  - serverless-webpack

custom:
  webpack:
    webpackConfig: webpack.config.js
    includeModules: true
    packager: npm
```

---

## „Éá„Éó„É≠„Ç§

### Âü∫Êú¨„Éá„Éó„É≠„Ç§

```bash
# „Éá„Éó„É≠„Ç§
serverless deploy

# „Çπ„ÉÜ„Éº„Ç∏ÊåáÂÆö
serverless deploy --stage prod

# „É™„Éº„Ç∏„Éß„É≥ÊåáÂÆö
serverless deploy --region us-east-1

# Ë©≥Á¥∞„É≠„Ç∞
serverless deploy --verbose
```

### Èñ¢Êï∞„ÅÆ„Åø„Éá„Éó„É≠„Ç§

```bash
# ÁâπÂÆö„ÅÆÈñ¢Êï∞„ÅÆ„Åø„Éá„Éó„É≠„Ç§ÔºàÈ´òÈÄüÔºâ
serverless deploy function --function hello

# „Çπ„ÉÜ„Éº„Ç∏ÊåáÂÆö
serverless deploy function --function hello --stage prod
```

### ÂâäÈô§

```bash
# „Çπ„Çø„ÉÉ„ÇØÂÖ®‰ΩìÂâäÈô§
serverless remove

# „Çπ„ÉÜ„Éº„Ç∏ÊåáÂÆö
serverless remove --stage dev
```

### „Éá„Éó„É≠„Ç§ÊÉÖÂ†±Á¢∫Ë™ç

```bash
# „Éá„Éó„É≠„Ç§ÊÉÖÂ†±Ë°®Á§∫
serverless info

# „Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÁ¢∫Ë™ç
serverless info --verbose
```

### „É≠„Ç∞Á¢∫Ë™ç

```bash
# „É≠„Ç∞„Çí„Çπ„Éà„É™„Éº„Éü„É≥„Ç∞
serverless logs --function hello --tail

# ÈÅéÂéª„ÅÆ„É≠„Ç∞Á¢∫Ë™ç
serverless logs --function hello --startTime 1h
```

### „É≠„Éº„Ç´„É´ÂÆüË°å

```bash
# Èñ¢Êï∞„Çí„É≠„Éº„Ç´„É´„ÅßÂÆüË°å
serverless invoke local --function hello

# „Éá„Éº„Çø‰ªò„ÅçÂÆüË°å
serverless invoke local --function hello --data '{"name": "John"}'

# „Éï„Ç°„Ç§„É´„Åã„ÇâË™≠„ÅøËæº„Åø
serverless invoke local --function hello --path data.json
```

### „Ç™„Éï„É©„Ç§„É≥ÈñãÁô∫

```bash
# serverless-offline ‰ΩøÁî®
npm install -D serverless-offline

# „É≠„Éº„Ç´„É´„Çµ„Éº„Éê„ÉºËµ∑Âãï
serverless offline

# „Éù„Éº„ÉàÊåáÂÆö
serverless offline --httpPort 3000
```

---

## Áí∞Â¢ÉÂ§âÊï∞„Å®„Ç∑„Éº„ÇØ„É¨„ÉÉ„Éà

### Áí∞Â¢ÉÂ§âÊï∞

```yaml
# serverless.yml
provider:
  environment:
    # Âõ∫ÂÆöÂÄ§
    STAGE: ${self:provider.stage}
    REGION: ${self:provider.region}

    # .env „Éï„Ç°„Ç§„É´„Åã„Çâ
    API_KEY: ${env:API_KEY}

    # „Ç´„Çπ„Çø„É†Â§âÊï∞„Åã„Çâ
    TABLE_NAME: ${self:custom.tableName}

    # AWS „É™„ÇΩ„Éº„ÇπÂèÇÁÖß
    BUCKET_NAME:
      Ref: UploadsBucket

# Èñ¢Êï∞„É¨„Éô„É´Áí∞Â¢ÉÂ§âÊï∞
functions:
  api:
    handler: handler.main
    environment:
      FUNCTION_SPECIFIC: value
```

### .env „Éï„Ç°„Ç§„É´

```bash
# .env.dev
API_KEY=dev-key-123
DATABASE_URL=dev-db-url

# .env.prod
API_KEY=prod-key-456
DATABASE_URL=prod-db-url
```

```yaml
# serverless.yml
plugins:
  - serverless-dotenv-plugin

custom:
  dotenv:
    path: .env.${self:provider.stage}
```

### AWS Systems Manager Parameter Store

```yaml
provider:
  environment:
    DB_PASSWORD: ${ssm:/myapp/${self:provider.stage}/db-password~true}
    # ~true „Åß SecureString „Å®„Åó„Å¶ÂèñÂæó
```

### AWS Secrets Manager

```yaml
provider:
  environment:
    API_SECRET: ${ssm:/aws/reference/secretsmanager/myapp/${self:provider.stage}/api-secret}
```

---

## „É¢„Éã„Çø„É™„É≥„Ç∞

### CloudWatch Logs

```yaml
# „É≠„Ç∞‰øùÊåÅÊúüÈñìË®≠ÂÆö
provider:
  logRetentionInDays: 7

functions:
  api:
    handler: handler.main
    # Èñ¢Êï∞„Åî„Å®„ÅÆ„É≠„Ç∞Ë®≠ÂÆö
    logRetentionInDays: 14
```

```typescript
// ÊßãÈÄ†Âåñ„É≠„Ç∞
export const handler = async (event: any) => {
  console.log(JSON.stringify({
    level: 'info',
    message: 'Processing request',
    requestId: event.requestContext.requestId,
    userId: event.userId
  }))
}
```

### X-Ray „Éà„É¨„Éº„Ç∑„É≥„Ç∞

```yaml
provider:
  tracing:
    lambda: true
    apiGateway: true

functions:
  api:
    handler: handler.main
    tracing: Active
```

### CloudWatch „É°„Éà„É™„ÇØ„Çπ

```yaml
functions:
  api:
    handler: handler.main
    alarms:
      - functionErrors
      - functionThrottles
      - functionInvocations
      - functionDuration
```

### „Ç´„Çπ„Çø„É†„É°„Éà„É™„ÇØ„Çπ

```typescript
import { CloudWatch } from '@aws-sdk/client-cloudwatch'

const cloudwatch = new CloudWatch({})

export const handler = async () => {
  await cloudwatch.putMetricData({
    Namespace: 'MyApp',
    MetricData: [
      {
        MetricName: 'OrdersProcessed',
        Value: 1,
        Unit: 'Count',
        Timestamp: new Date()
      }
    ]
  })
}
```

---

## „Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ

### 1. „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÊßãÊàê

```
‚úì Èñ¢Êï∞„ÇíË≤¨Âãô„Åî„Å®„Å´ÂàÜÂâ≤
‚úì ÂÖ±ÈÄö„É≠„Ç∏„ÉÉ„ÇØ„Çí utils/ „Å´ÈõÜÁ¥Ñ
‚úì ÂûãÂÆöÁæ©„Çí types/ „Å´ÈõÜÁ¥Ñ
‚úì Áí∞Â¢É„Åî„Å®„ÅÆË®≠ÂÆö„Éï„Ç°„Ç§„É´ÂàÜÈõ¢
```

### 2. IAM Ê®©Èôê„ÅØÊúÄÂ∞èÈôê„Å´

```yaml
# ‚úó ÊÇ™„ÅÑ‰æã
provider:
  iam:
    role:
      statements:
        - Effect: Allow
          Action: '*'
          Resource: '*'

# ‚óã ËâØ„ÅÑ‰æã
provider:
  iam:
    role:
      statements:
        - Effect: Allow
          Action:
            - dynamodb:GetItem
            - dynamodb:PutItem
          Resource:
            - Fn::GetAtt: [UsersTable, Arn]
```

### 3. Áí∞Â¢ÉÂ§âÊï∞ÁÆ°ÁêÜ

```yaml
# ‚óã „Çπ„ÉÜ„Éº„Ç∏„Åî„Å®„Å´ÂàÜÈõ¢
custom:
  config:
    dev:
      memorySize: 256
      timeout: 30
    prod:
      memorySize: 1024
      timeout: 10

functions:
  api:
    handler: handler.main
    memorySize: ${self:custom.config.${self:provider.stage}.memorySize}
    timeout: ${self:custom.config.${self:provider.stage}.timeout}
```

### 4. „Ç≥„Éº„É´„Éâ„Çπ„Çø„Éº„ÉàÂØæÁ≠ñ

```yaml
# Lambda „Ç¶„Ç©„Éº„É†„Ç¢„ÉÉ„Éó
plugins:
  - serverless-plugin-warmup

custom:
  warmup:
    default:
      enabled: true
      events:
        - schedule: rate(5 minutes)
      concurrency: 1
```

```typescript
// „Ç≥„Éº„É´„Éâ„Çπ„Çø„Éº„ÉàÊúÄÈÅ©Âåñ
import { DynamoDBClient } from '@aws-sdk/client-dynamodb'

// „Ç∞„É≠„Éº„Éê„É´„Çπ„Ç≥„Éº„Éó„ÅßÂàùÊúüÂåñ
const client = new DynamoDBClient({})

export const handler = async (event: any) => {
  // ÂÜçÂà©Áî®„Åï„Çå„Çã
  // ...
}
```

### 5. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞

```typescript
// src/utils/response.ts
export const success = (data: any) => ({
  statusCode: 200,
  headers: {
    'Content-Type': 'application/json',
    'Access-Control-Allow-Origin': '*'
  },
  body: JSON.stringify(data)
})

export const error = (statusCode: number, message: string) => ({
  statusCode,
  headers: {
    'Content-Type': 'application/json',
    'Access-Control-Allow-Origin': '*'
  },
  body: JSON.stringify({ error: message })
})

// ‰ΩøÁî®‰æã
export const handler = async (event: any) => {
  try {
    const result = await processRequest(event)
    return success(result)
  } catch (err) {
    console.error('Error:', err)
    return error(500, 'Internal server error')
  }
}
```

### 6. „Éê„É≥„Éâ„É´„Çµ„Ç§„Ç∫ÊúÄÈÅ©Âåñ

```yaml
# serverless.yml
custom:
  esbuild:
    bundle: true
    minify: true
    sourcemap: false
    target: node18
    exclude:
      - aws-sdk
      - '@aws-sdk/*'

    # Tree shaking
    treeShaking: true
```

### 7. „É¨„Ç§„É§„Éº„ÅÆÊ¥ªÁî®

```yaml
# ÂÖ±ÈÄö„É©„Ç§„Éñ„É©„É™„Çí„É¨„Ç§„É§„ÉºÂåñ
layers:
  dependencies:
    path: layers/dependencies
    name: ${self:service}-${self:provider.stage}-dependencies
    description: Common dependencies
    compatibleRuntimes:
      - nodejs18.x

functions:
  api:
    handler: handler.main
    layers:
      - Ref: DependenciesLambdaLayer
```

### 8. „Çø„Ç§„É†„Ç¢„Ç¶„Éà„Å®„É°„É¢„É™

```yaml
functions:
  # ËªΩ„ÅÑÂá¶ÁêÜ
  hello:
    handler: handler.hello
    memorySize: 128
    timeout: 3

  # Èáç„ÅÑÂá¶ÁêÜ
  processData:
    handler: handler.processData
    memorySize: 1024
    timeout: 60

  # Èï∑ÊôÇÈñìÂá¶ÁêÜÔºàÊúÄÂ§ß15ÂàÜÔºâ
  batchJob:
    handler: handler.batchJob
    memorySize: 3008
    timeout: 900
```

### 9. VPC Ë®≠ÂÆöÔºàÂøÖË¶Å„Å™Â†¥Âêà„ÅÆ„ÅøÔºâ

```yaml
provider:
  vpc:
    securityGroupIds:
      - sg-xxxxxxxxx
    subnetIds:
      - subnet-xxxxxxxxx
      - subnet-yyyyyyyyy

# ‚ö†Ô∏è Ê≥®ÊÑè: VPCÂÜÖ„Å´ÈÖçÁΩÆ„Åô„Çã„Å®„Ç≥„Éº„É´„Éâ„Çπ„Çø„Éº„Éà„ÅåÈÅÖ„Åè„Å™„Çã
# RDS„ÇÑElastiCacheÊé•Á∂öÊôÇ„ÅÆ„Åø‰ΩøÁî®
```

### 10. „Éá„Éó„É≠„Ç§Ââç„ÅÆ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥

```bash
# package.json
{
  "scripts": {
    "validate": "serverless package",
    "deploy:dev": "npm run validate && serverless deploy --stage dev",
    "deploy:prod": "npm run validate && serverless deploy --stage prod"
  }
}
```

---

## CI/CD

### GitHub Actions

```yaml
# .github/workflows/deploy.yml
name: Deploy

on:
  push:
    branches:
      - main
      - develop

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: Install dependencies
        run: npm ci

      - name: Deploy to dev
        if: github.ref == 'refs/heads/develop'
        run: npm run deploy:dev
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

      - name: Deploy to prod
        if: github.ref == 'refs/heads/main'
        run: npm run deploy:prod
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
```

---

## „Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞

### „Éá„Éó„É≠„Ç§„Ç®„É©„Éº

```bash
# „Çπ„Çø„ÉÉ„ÇØÁä∂ÊÖãÁ¢∫Ë™ç
aws cloudformation describe-stacks --stack-name my-service-dev

# „Çπ„Çø„ÉÉ„ÇØ„Ç§„Éô„É≥„ÉàÁ¢∫Ë™ç
aws cloudformation describe-stack-events --stack-name my-service-dev

# Â§±Êïó„Åó„Åü„Çπ„Çø„ÉÉ„ÇØÂâäÈô§
serverless remove --stage dev
```

### „É≠„Ç∞Á¢∫Ë™ç

```bash
# „É™„Ç¢„É´„Çø„Ç§„É†„É≠„Ç∞
serverless logs --function api --tail --stage dev

# ÈÅéÂéª1ÊôÇÈñì„ÅÆ„É≠„Ç∞
serverless logs --function api --startTime 1h --stage dev

# „Ç®„É©„Éº„É≠„Ç∞„ÅÆ„Åø
serverless logs --function api --filter "ERROR" --stage dev
```

### „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÂïèÈ°å

```bash
# X-Ray „Åß„Éà„É¨„Éº„ÇπÁ¢∫Ë™ç
aws xray get-trace-summaries --start-time $(date -u -d '1 hour ago' +%s) --end-time $(date -u +%s)

# „É°„É¢„É™‰ΩøÁî®ÈáèÁ¢∫Ë™ç
serverless metrics --function api --stage dev
```

---

## ÂèÇËÄÉ„É™„É≥„ÇØ

- [Serverless Framework Documentation](https://www.serverless.com/framework/docs)
- [AWS Lambda Best Practices](https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html)
- [Serverless Examples](https://github.com/serverless/examples)
