# Swagger / OpenAPI ÂÆåÂÖ®„Ç¨„Ç§„Éâ

## ÁõÆÊ¨°
- [Ê¶ÇË¶Å](#Ê¶ÇË¶Å)
- [OpenAPI‰ªïÊßò](#openapi‰ªïÊßò)
- [Swagger UI](#swagger-ui)
- [„Ç≥„Éº„ÉâÁîüÊàê](#„Ç≥„Éº„ÉâÁîüÊàê)
- [„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØÁµ±Âêà](#„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØÁµ±Âêà)
- [„Éê„É™„Éá„Éº„Ç∑„Éß„É≥](#„Éê„É™„Éá„Éº„Ç∑„Éß„É≥)

---

## Ê¶ÇË¶Å

REST API „ÅÆ‰ªïÊßò„ÇíË®òËø∞„ÉªÊñáÊõ∏Âåñ„Åô„Çã„Åü„ÇÅ„ÅÆÊ®ôÊ∫ñ„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÄÇ

### Áî®Ë™û
- **OpenAPI**: API‰ªïÊßò„ÅÆÊ®ôÊ∫ñ„Éï„Ç©„Éº„Éû„ÉÉ„Éà (Êóß: Swagger Specification)
- **Swagger**: OpenAPI„ÅÆ„ÉÑ„Éº„É´„Çª„ÉÉ„Éà (UI, Editor, CodegenÁ≠â)

### „É°„É™„ÉÉ„Éà
- üìù API‰ªïÊßò„ÅÆÊ®ôÊ∫ñÂåñ
- üé® „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å™„Éâ„Ç≠„É•„É°„É≥„Éà
- üîß „Ç≥„Éº„ÉâËá™ÂãïÁîüÊàê
- ‚úÖ „É™„ÇØ„Ç®„Çπ„Éà/„É¨„Çπ„Éù„É≥„Çπ„ÅÆ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥

---

## OpenAPI‰ªïÊßò

### Âü∫Êú¨ÊßãÈÄ†

```yaml
# openapi.yaml
openapi: 3.0.3
info:
  title: My API
  description: API documentation
  version: 1.0.0
  contact:
    name: API Support
    email: support@example.com

servers:
  - url: https://api.example.com/v1
    description: Production
  - url: http://localhost:3000/v1
    description: Development

paths:
  /users:
    get:
      summary: Get all users
      tags:
        - Users
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'

components:
  schemas:
    User:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: string
        name:
          type: string
        email:
          type: string
          format: email
```

### „Éë„ÇπÂÆöÁæ©

```yaml
paths:
  /users:
    get:
      summary: Get all users
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Success

    post:
      summary: Create user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserInput'
      responses:
        '201':
          description: Created

  /users/{id}:
    get:
      summary: Get user by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
        '404':
          description: Not found
```

### „Çπ„Ç≠„Éº„ÉûÂÆöÁæ©

```yaml
components:
  schemas:
    User:
      type: object
      required:
        - id
        - name
        - email
      properties:
        id:
          type: string
          example: "123"
        name:
          type: string
          minLength: 1
          maxLength: 100
          example: "John Doe"
        email:
          type: string
          format: email
          example: "john@example.com"
        age:
          type: integer
          minimum: 0
          maximum: 150
          example: 30
        role:
          type: string
          enum: [admin, user, guest]
          default: user
        createdAt:
          type: string
          format: date-time

    UserInput:
      type: object
      required:
        - name
        - email
      properties:
        name:
          type: string
        email:
          type: string
          format: email
        age:
          type: integer
```

### Ë™çË®º

```yaml
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

    ApiKey:
      type: apiKey
      in: header
      name: X-API-Key

    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://example.com/oauth/authorize
          tokenUrl: https://example.com/oauth/token
          scopes:
            read: Read access
            write: Write access

security:
  - BearerAuth: []

paths:
  /users:
    get:
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Success
        '401':
          description: Unauthorized
```

---

## Swagger UI

„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å™API„Éâ„Ç≠„É•„É°„É≥„Éà„ÄÇ

### ExpressÁµ±Âêà

```bash
npm install swagger-ui-express yamljs
```

```typescript
import express from 'express'
import swaggerUi from 'swagger-ui-express'
import YAML from 'yamljs'

const app = express()
const swaggerDocument = YAML.load('./openapi.yaml')

app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerDocument, {
  customCss: '.swagger-ui .topbar { display: none }',
  customSiteTitle: 'My API Documentation'
}))

app.listen(3000, () => {
  console.log('API docs: http://localhost:3000/api-docs')
})
```

### FastifyÁµ±Âêà

```bash
npm install @fastify/swagger @fastify/swagger-ui
```

```typescript
import fastify from 'fastify'
import swagger from '@fastify/swagger'
import swaggerUi from '@fastify/swagger-ui'

const server = fastify()

await server.register(swagger, {
  openapi: {
    info: {
      title: 'My API',
      version: '1.0.0'
    }
  }
})

await server.register(swaggerUi, {
  routePrefix: '/docs',
  uiConfig: {
    docExpansion: 'list',
    deepLinking: false
  }
})

server.get('/users', {
  schema: {
    description: 'Get all users',
    tags: ['Users'],
    response: {
      200: {
        type: 'array',
        items: {
          type: 'object',
          properties: {
            id: { type: 'string' },
            name: { type: 'string' }
          }
        }
      }
    }
  }
}, async (req, reply) => {
  return [{ id: '1', name: 'John' }]
})

await server.listen({ port: 3000 })
```

### NestJSÁµ±Âêà

```bash
npm install @nestjs/swagger
```

```typescript
// main.ts
import { NestFactory } from '@nestjs/core'
import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger'
import { AppModule } from './app.module'

async function bootstrap() {
  const app = await NestFactory.create(AppModule)

  const config = new DocumentBuilder()
    .setTitle('My API')
    .setDescription('API documentation')
    .setVersion('1.0')
    .addBearerAuth()
    .build()

  const document = SwaggerModule.createDocument(app, config)
  SwaggerModule.setup('api', app, document)

  await app.listen(3000)
}
bootstrap()

// user.controller.ts
import { Controller, Get, Post, Body } from '@nestjs/common'
import { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger'
import { CreateUserDto } from './dto/create-user.dto'
import { User } from './entities/user.entity'

@ApiTags('users')
@Controller('users')
export class UserController {
  @Get()
  @ApiOperation({ summary: 'Get all users' })
  @ApiResponse({ status: 200, description: 'Success', type: [User] })
  findAll(): User[] {
    return []
  }

  @Post()
  @ApiOperation({ summary: 'Create user' })
  @ApiResponse({ status: 201, description: 'Created', type: User })
  create(@Body() createUserDto: CreateUserDto): User {
    return {} as User
  }
}
```

---

## „Ç≥„Éº„ÉâÁîüÊàê

OpenAPI‰ªïÊßò„Åã„Çâ„Ç≥„Éº„Éâ„ÇíËá™ÂãïÁîüÊàê„ÄÇ

### „ÇØ„É©„Ç§„Ç¢„É≥„Éà„Ç≥„Éº„ÉâÁîüÊàê

```bash
npm install @openapitools/openapi-generator-cli
```

```bash
# TypeScript Axios
npx openapi-generator-cli generate \
  -i openapi.yaml \
  -g typescript-axios \
  -o ./src/api

# TypeScript Fetch
npx openapi-generator-cli generate \
  -i openapi.yaml \
  -g typescript-fetch \
  -o ./src/api
```

### ÁîüÊàê„Åï„Çå„Åü„Ç≥„Éº„Éâ‰ΩøÁî®‰æã

```typescript
import { UsersApi, Configuration } from './api'

const config = new Configuration({
  basePath: 'https://api.example.com',
  accessToken: 'your-token'
})

const api = new UsersApi(config)

// „É¶„Éº„Ç∂„Éº‰∏ÄË¶ßÂèñÂæó
const users = await api.getUsers()

// „É¶„Éº„Ç∂„Éº‰ΩúÊàê
const newUser = await api.createUser({
  name: 'John Doe',
  email: 'john@example.com'
})
```

### orval

„Çà„Çä„É¢„ÉÄ„É≥„Å™„Ç≥„Éº„ÉâÁîüÊàê„ÉÑ„Éº„É´„ÄÇ

```bash
npm install --save-dev orval
```

```javascript
// orval.config.js
module.exports = {
  api: {
    input: './openapi.yaml',
    output: {
      mode: 'tags-split',
      target: './src/api',
      client: 'react-query',
      mock: true
    }
  }
}
```

```bash
npx orval
```

```typescript
// ÁîüÊàê„Åï„Çå„ÅüReact Query hooks
import { useGetUsers, useCreateUser } from './api/users'

function UserList() {
  const { data: users, isLoading } = useGetUsers()
  const createUser = useCreateUser()

  const handleCreate = async () => {
    await createUser.mutateAsync({
      data: { name: 'John', email: 'john@example.com' }
    })
  }

  if (isLoading) return <div>Loading...</div>

  return (
    <div>
      {users?.map(user => <div key={user.id}>{user.name}</div>)}
      <button onClick={handleCreate}>Create</button>
    </div>
  )
}
```

---

## „Éï„É¨„Éº„É†„ÉØ„Éº„ÇØÁµ±Âêà

### tRPC + OpenAPI

```bash
npm install trpc-openapi
```

```typescript
import { initTRPC } from '@trpc/server'
import { OpenApiMeta } from 'trpc-openapi'

const t = initTRPC.meta<OpenApiMeta>().create()

export const appRouter = t.router({
  getUsers: t.procedure
    .meta({
      openapi: {
        method: 'GET',
        path: '/users',
        tags: ['Users'],
        summary: 'Get all users'
      }
    })
    .input(z.void())
    .output(z.array(UserSchema))
    .query(async () => {
      return await db.users.findMany()
    })
})

// OpenAPI‰ªïÊßòÁîüÊàê
import { generateOpenApiDocument } from 'trpc-openapi'

export const openApiDocument = generateOpenApiDocument(appRouter, {
  title: 'My API',
  version: '1.0.0',
  baseUrl: 'http://localhost:3000'
})
```

### Hono + Zod OpenAPI

```bash
npm install @hono/zod-openapi
```

```typescript
import { createRoute, OpenAPIHono, z } from '@hono/zod-openapi'

const app = new OpenAPIHono()

const UserSchema = z.object({
  id: z.string().openapi({ example: '123' }),
  name: z.string().openapi({ example: 'John Doe' }),
  email: z.string().email().openapi({ example: 'john@example.com' })
})

const route = createRoute({
  method: 'get',
  path: '/users',
  responses: {
    200: {
      content: {
        'application/json': {
          schema: z.array(UserSchema)
        }
      },
      description: 'Get all users'
    }
  }
})

app.openapi(route, (c) => {
  return c.json([
    { id: '1', name: 'John', email: 'john@example.com' }
  ])
})

// OpenAPI JSON
app.doc('/doc', {
  openapi: '3.0.0',
  info: {
    version: '1.0.0',
    title: 'My API'
  }
})
```

---

## „Éê„É™„Éá„Éº„Ç∑„Éß„É≥

### express-openapi-validator

```bash
npm install express-openapi-validator
```

```typescript
import express from 'express'
import * as OpenApiValidator from 'express-openapi-validator'

const app = express()

app.use(
  OpenApiValidator.middleware({
    apiSpec: './openapi.yaml',
    validateRequests: true,
    validateResponses: true
  })
)

app.get('/users', (req, res) => {
  res.json([{ id: '1', name: 'John' }])
})

// „Ç®„É©„Éº„Éè„É≥„Éâ„É©„Éº
app.use((err, req, res, next) => {
  res.status(err.status || 500).json({
    error: err.message
  })
})
```

---

## „ÉÑ„Éº„É´

### Swagger Editor

```bash
# Docker
docker run -p 8080:8080 swaggerapi/swagger-editor

# „Ç™„É≥„É©„Ç§„É≥
https://editor.swagger.io/
```

### Swagger Codegen

```bash
# CLI
npm install -g @openapitools/openapi-generator-cli

# „Ç≥„Éº„ÉâÁîüÊàê
openapi-generator-cli generate -i openapi.yaml -g typescript-axios -o ./client
```

### PostmanÈÄ£Êê∫

```
Postman ‚Üí Import ‚Üí OpenAPI 3.0 ‚Üí openapi.yaml„Çí„Ç§„É≥„Éù„Éº„Éà
```

---

## „Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ

### ‚úì Êé®Â•®

```yaml
# Ë©≥Á¥∞„Å™Ë™¨Êòé
paths:
  /users:
    get:
      summary: Get all users
      description: |
        Returns a list of users with pagination support.
        Requires authentication.
      parameters:
        - name: page
          description: Page number (1-indexed)
          schema:
            type: integer
            minimum: 1
            default: 1

# ‰æã„ÇíÂê´„ÇÅ„Çã
components:
  schemas:
    User:
      properties:
        id:
          type: string
          example: "123"
        name:
          type: string
          example: "John Doe"

# „Ç®„É©„Éº„É¨„Çπ„Éù„É≥„ÇπÂÆöÁæ©
responses:
  '400':
    description: Bad Request
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/Error'
```

### ‚úó ÈÅø„Åë„Çã„Åπ„Åç

```yaml
# ‰∏çÂçÅÂàÜ„Å™Ë™¨Êòé
paths:
  /users:
    get:
      summary: Get users

# ‰æã„Åå„Å™„ÅÑ
components:
  schemas:
    User:
      properties:
        id:
          type: string

# „Ç®„É©„Éº„É¨„Çπ„Éù„É≥„Çπ„Åå„Å™„ÅÑ
```

---

## ÂèÇËÄÉ„É™„É≥„ÇØ

- [OpenAPI Specification](https://spec.openapis.org/oas/latest.html)
- [Swagger UI](https://swagger.io/tools/swagger-ui/)
- [Swagger Editor](https://editor.swagger.io/)
- [OpenAPI Generator](https://openapi-generator.tech/)
